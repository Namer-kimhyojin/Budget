import{c as q,j as e,a as f,m as xe,f as me,S as Ge,e as qe,g as He,R as Te,M as Xe,h as Y}from"./index-zrOWfT8F.js";import{P as Ke,F as Re,T as Ze}from"./triangle-alert-B3xAXXJr.js";import{C as fe,T as le,X as Je}from"./x-DmlADNKy.js";import{E as Ee,D as je,L as Qe,C as et,P as tt}from"./paperclip-DhIonsE5.js";import{P as De}from"./pen-8gtTHQgu.js";import{S as nt}from"./StatusBadge-BWeRFWtv.js";import{D as rt,T as st}from"./trending-up-Dlo1Iyf6.js";import{C as ot}from"./chevron-down-_dFhnU8j.js";const at=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],it=q("arrow-left",at);const lt=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],dt=q("arrow-up-down",lt);const ct=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ne=q("calendar",ct);const ft=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ut=q("chevron-up",ft);const pt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]],ue=q("circle-pause",pt);const gt=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],pe=q("circle-play",gt);const xt=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],bt=q("hash",xt);const ht=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],yt=q("layout-grid",ht);const mt=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],jt=q("list",mt);const kt=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],St=q("square-check-big",kt);function ke({isOpen:t,onClose:a,title:o,children:j,footer:u,width:S=500}){return t?e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15, 23, 42, 0.6)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:20},children:e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:16,width:"100%",maxWidth:S,boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04)",display:"flex",flexDirection:"column",maxHeight:"90vh"},children:[e.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0,fontSize:"18px",fontWeight:800,color:"#0f172a"},children:o}),e.jsx("button",{onClick:a,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#94a3b8",lineHeight:1},children:"×"})]}),e.jsx("div",{style:{padding:"20px 24px",overflowY:"auto",flex:1},children:j}),u&&e.jsx("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",display:"flex",justifyContent:"flex-end",gap:12,backgroundColor:"#f8fafc",borderBottomLeftRadius:16,borderBottomRightRadius:16},children:u})]})}):null}const n={pageTitle:"접수 관리",listTitle:"접수 목록",detailTitle:"접수 상세",masterTitle:"예산서 마스터",roundDetail:"회차 상세",round:"회차",inputPeriod:"입력 기간",newRoundBtn:"신규 예산서 접수",editRoundBtn:"회차 정보 수정",refreshStatus:"현황 새로고침",goToList:"목록으로",progressByDept:"부서별 진행 현황",bulkUploadTitle:"예산 항목 일괄 등록",exportOfficialBook:"공식 예산서 출력",no:"번호",year:"연도",name:"예산명",period:"기간",startDate:"시작일",endDate:"종료일",createdAt:"생성일",defaultSort:"기본(활성/연도)",dday:"D-day",status:"상태",currentStatus:"현재 상태",statusControl:"상태 제어",management:"관리",dept:"부서",entryCount:"항목 수",totalAmount:"예산 합계",sourceRound:"기초데이터 원본",draft:"준비중",pending:"제출대기",confirmed:"확정",closed:"마감",active:"진행",applyYear:"적용 연도",roundName:"예산명칭",createMode:"기초데이터 설정",newCreate:"빈 상태로 시작",copyRound:"기존 회차 불러오기",originalRound:"불러올 회차",selectOriginal:"원본 회차 선택",copyNotice:"불러온 데이터는 당초 예산액 기준으로 저장되며, 증감액은 현예산액과 기존 예산액의 차이로 표시됩니다.",periodSetting:"입력 접수 기간 설정",guidelinesLabel:"부서별 작성 지침(공통)",guidelinesPlaceholder:"예산 작성 시 부서에서 참고할 지침을 입력하세요.",fileUploadLabel:"첨부 파일 등록",currentFile:"현재 파일: ",uploadPlaceholder:"파일을 드래그하거나 클릭하여 업로드하세요.",removeFile:"파일 제거",searchPlaceholder:"사업명 검색..",namePlaceholder:"예: 2027년 본예산",bulkFormat:"형식: `subject_code, org_code, name, price, qty` (콤마 구분, 줄 단위)",bulkExample:"예: 1101, D001, 사무용품, 50000, 2",noData:"표시할 데이터가 없습니다.",noProgressData:"표시할 진행 현황 데이터가 없습니다.",loadingProgress:"진행 현황을 불러오는 중...",periodUndefined:"기간 미정",save:"저장",cancel:"취소",delete:"삭제",deactivate:"비활성화",edit:"수정",view:"보기",upload:"업로드 실행",confirmDelete:t=>`"${t}" 버전을 삭제하시겠습니까? 관련 데이터도 모두 삭제됩니다.`,deleteSuccess:"삭제했습니다.",deleteFail:"삭제 실패",alreadyClosed:"이미 마감된 버전입니다.",confirmDeactivate:t=>`"${t}" 버전을 비활성화(마감)하시겠습니까?`,deactivateSuccess:"비활성화했습니다.",changeFail:"변경 실패",transferRequired:"기초데이터 불러오기를 선택한 경우 원본 회차를 선택해야 합니다.",newRoundName:t=>`${t}년 신규 회차`,createSuccess:t=>`신규 예산서가 접수되었습니다.${t>0?`
불러온 항목: ${t.toLocaleString()}건`:""}`,createFail:"생성 실패",updateSuccess:"버전 정보가 업데이트되었습니다.",updateFail:"상태 변경 실패",saveSuccess:"버전 정보가 저장되었습니다.",saveFail:"저장 실패",inputRequired:"항목을 입력해 주세요.",uploadSuccess:(t,a)=>`업로드 완료: ${t} 생성, ${a} 업데이트`,uploadFail:"업로드 실패",exportOfficialBookDone:"공식 예산서 파일을 다운로드했습니다.",exportOfficialBookFail:"공식 예산서 출력 중 오류가 발생했습니다.",sourceVersionEmpty:"선택한 원본 회차에 예산 항목이 없습니다. 다른 회차를 선택하거나 빈 상태로 시작하세요.",closeSuccess:"회차를 마감했습니다.",closeFail:"마감 처리 중 오류가 발생했습니다.",reopenSuccess:"마감을 해제했습니다.",reopenFail:"마감 해제 중 오류가 발생했습니다.",confirmClose:t=>`"${t}" 회차를 마감합니까?
마감 후에는 모든 편집이 잠깁니다.`,confirmReopen:t=>`"${t}" 회차의 마감을 해제합니까?`,summaryTotalRounds:"전체 예산서",summaryActiveRound:"진행 중 회차",summaryDeptStatus:"부서 현황",summaryCompleted:"완료",summaryInProgress:"진행중",summaryNotStarted:"미시작",summaryTotalEntries:"전체 항목",summaryTotalAmount:"합계 금액",summaryDeadline:"마감 기한",summaryNoPending:"진행 중인 회차 없음",listMainTitle:"예산서 목록",layoutCard:"카드",layoutList:"목록",layoutCardTitle:"카드 보기",layoutListTitle:"목록 보기",sortTitle:"정렬 항목",sortDirTitle:"정렬 방향 전환",sortDirAsc:"오름차순",sortDirDesc:"내림차순",batchSelected:t=>`${t}개 선택됨`,batchStart:"접수 개시",batchClose:"일괄 마감",batchDelete:"일괄 삭제",yearUnit:"년도",rankUnit:"번째 예산",periodNotSet:"기간 미설정",guidelinesExist:"있음",guidelinesNone:"없음",guidelineBadge:"작성 지침 있음",deptProgress:"부서 편성 현황",statsCompletedIcon:"✅ 완료",statsInProgressIcon:"⏳ 진행",statsNotStartedIcon:"⚪ 미시작",selectAll:"전체 선택",unselectAll:"선택 해제",batchSelectTitle:"일괄 작업용 선택",idLabel:"ID",reopen:"재개",close:"마감",totalEntries:"전체 항목 수",totalSum:"전체 예산 합계"},{simpleSelect:vt}=xe,Ct=`
    .version-intake-list .vi-card-title {
        font-size: 20px !important;
        line-height: 1.25 !important;
    }
    .version-intake-list .vi-progress-stats {
        font-size: 10.5px !important;
    }
`,de={DRAFT:{label:"대기중",color:"#64748b",bg:"#f1f5f9",border:"#e2e8f0",dot:"#94a3b8"},PENDING:{label:"접수중",color:"#1d4ed8",bg:"#eff6ff",border:"#bfdbfe",dot:"#3b82f6"},EXPIRED:{label:"접수마감",color:"#c2410c",bg:"#ffedd5",border:"#fdba74",dot:"#f97316"},CONFIRMED:{label:"확정",color:"#065f46",bg:"#ecfdf5",border:"#a7f3d0",dot:"#10b981"},CLOSED:{label:"마감",color:"#92400e",bg:"#fffbeb",border:"#fde68a",dot:"#f59e0b"}},Se={DRAFT:1,PENDING:2,EXPIRED:3,CONFIRMED:4,CLOSED:5},ve=t=>["PENDING","DRAFT","EXPIRED"].includes(String(t||"").toUpperCase()),te=t=>{if(!t)return 0;const a=new Date(t).getTime();return Number.isFinite(a)?a:0};function ce(t,a){const o=ve(t.status)?1:0,j=ve(a.status)?1:0;return j!==o?j-o:a.year!==t.year?a.year-t.year:(a.round||0)!==(t.round||0)?(a.round||0)-(t.round||0):String(t.id).localeCompare(String(a.id))}function ge(t){if(!t)return null;const a=new Date(t);a.setHours(23,59,59,999);const o=Math.ceil((a-Date.now())/864e5);return o===0?{label:"D-Day",color:"#dc2626",bg:"#fef2f2",border:"#fca5a5"}:o>0&&o<=3?{label:`D-${o}`,color:"#ea580c",bg:"#fff7ed",border:"#fed7aa"}:o>0&&o<=7?{label:`D-${o}`,color:"#ca8a04",bg:"#fefce8",border:"#fde68a"}:o>0?{label:`D-${o}`,color:"#16a34a",bg:"#f0fdf4",border:"#bbf7d0"}:{label:`D+${Math.abs(o)}`,color:"#94a3b8",bg:"#f1f5f9",border:"#e2e8f0"}}function _t({item:t,rank:a,canManage:o,handleGoDetail:j,setVersion:u,setIsEditModalOpen:S,handleCloseVersion:O,handleReopenVersion:p,handleDeleteVersion:$,progressMap:P,isSelected:v,onToggleSelect:i}){const y=t.status==="PENDING"||t.status==="DRAFT"||t.status==="EXPIRED",w=t.status==="CLOSED",E=de[t.status]||de.DRAFT,W=ge(t.end_date),D=f.useMemo(()=>{const m=P?.[t.id];if(!m?.length)return null;const N=m.length;if(!N)return null;const F=m.filter(c=>c.dept_status==="COMPLETED").length,X=m.filter(c=>["WRITING","SUBMITTED"].includes(c.dept_status)).length;return{total:N,completed:F,inProgress:X,pct:Math.round(F/N*100)}},[P,t.id]);return e.jsxs("div",{style:{background:"#fff",borderRadius:16,border:y?`2px solid ${E.border}`:"1px solid #e2e8f0",boxShadow:y?"0 4px 20px rgba(37,99,235,0.10), 0 1px 4px rgba(0,0,0,0.04)":"0 1px 4px rgba(0,0,0,0.04)",display:"flex",flexDirection:"column",overflow:"hidden",transition:"box-shadow 0.2s, transform 0.2s",opacity:w?.72:1,position:"relative"},onMouseEnter:m=>{m.currentTarget.style.boxShadow="0 8px 30px rgba(0,0,0,0.10)",m.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:m=>{m.currentTarget.style.boxShadow=y?"0 4px 20px rgba(37,99,235,0.10)":"0 1px 4px rgba(0,0,0,0.04)",m.currentTarget.style.transform="none"},children:[e.jsx("div",{style:{height:4,background:y?"linear-gradient(90deg, #2563eb, #60a5fa)":E.dot,borderRadius:"16px 16px 0 0"}}),e.jsxs("div",{style:{padding:"21px 18px",flex:1,display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8},children:[e.jsxs("div",{children:[e.jsx("button",{type:"button",className:"vi-card-title",title:"상세 보기",onClick:()=>j(t),style:{fontSize:18,fontWeight:900,color:"#0f172a",lineHeight:1.2,background:"none",border:"none",padding:0,margin:0,textAlign:"left",cursor:"pointer"},children:t.name}),e.jsxs("div",{className:"vi-card-meta",style:{fontSize:11,fontWeight:700,color:"#94a3b8",letterSpacing:"0.04em",marginTop:2},children:[t.year,n.yearUnit," · ",a,n.rankUnit]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:4,flexShrink:0},children:[e.jsxs("span",{className:"vi-status-badge",style:{display:"inline-flex",alignItems:"center",gap:4,fontSize:11,fontWeight:700,padding:"2px 8px",borderRadius:999,background:E.bg,color:E.color,border:`1px solid ${E.border}`},children:[e.jsx("span",{style:{width:5,height:5,borderRadius:"50%",background:E.dot,display:"inline-block"}}),E.label]}),y&&W&&e.jsx("span",{className:"vi-card-dday-badge",style:{fontSize:11,fontWeight:800,padding:"1px 7px",borderRadius:999,background:W.bg,color:W.color,border:`1px solid ${W.border}`},children:W.label})]})]}),e.jsxs("div",{className:"vi-date-row",style:{display:"flex",alignItems:"center",gap:6,fontSize:12,color:"#64748b"},children:[e.jsx(Ne,{size:13,style:{flexShrink:0}}),t.start_date?e.jsxs("span",{children:[e.jsx("b",{style:{color:"#334155"},children:t.start_date})," ~ ",e.jsx("b",{style:{color:"#334155"},children:t.end_date})]}):e.jsx("span",{style:{color:"#cbd5e1"},children:n.periodNotSet})]}),t.guidelines&&e.jsxs("div",{className:"vi-guideline",style:{display:"flex",alignItems:"center",gap:6,fontSize:10,color:"#2563eb",background:"#eff6ff",border:"1px solid #bfdbfe",borderRadius:6,padding:"3px 8px",alignSelf:"flex-start"},children:[e.jsx(Re,{size:11})," ",n.guidelineBadge]}),e.jsx("div",{style:{flex:1}}),D&&e.jsxs("div",{style:{marginTop:0,paddingTop:16,borderTop:"1px solid #f1f5f9"},children:[e.jsxs("div",{className:"vi-progress-head",style:{display:"flex",justifyContent:"space-between",fontSize:11,color:"#64748b",marginBottom:5},children:[e.jsx("span",{children:n.deptProgress}),e.jsxs("strong",{style:{fontWeight:800,color:D.pct===100?"#059669":"#2563eb"},children:[D.completed,"/",D.total," (",D.pct,"%)"]})]}),e.jsx("div",{style:{height:6,borderRadius:99,background:"#f1f5f9",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",borderRadius:99,background:D.pct===100?"linear-gradient(90deg,#10b981,#059669)":"linear-gradient(90deg,#60a5fa,#2563eb)",width:`${D.pct}%`,transition:"width 0.5s ease"}})}),e.jsxs("div",{className:"vi-progress-stats",style:{display:"flex",width:"100%",justifyContent:"flex-end",gap:6,marginTop:5,fontSize:11},children:[e.jsxs("span",{style:{color:"#059669",fontWeight:700},children:[n.statsCompletedIcon," ",D.completed]}),e.jsxs("span",{style:{color:"#d97706",fontWeight:700},children:[n.statsInProgressIcon," ",D.inProgress]}),e.jsxs("span",{style:{color:"#94a3b8"},children:[n.statsNotStartedIcon," ",D.total-D.completed-D.inProgress]})]})]})]}),e.jsxs("div",{style:{borderTop:"1px solid #f1f5f9",padding:"10px 16px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:v?"#f0f7ff":"#fafbfc",transition:"background 0.2s"},children:[o&&e.jsx("div",{onClick:m=>{m.stopPropagation(),i()},style:{width:18,height:18,borderRadius:5,background:v?"#2563eb":"#fff",border:`2px solid ${v?"#2563eb":"#cbd5e1"}`,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.15s",boxShadow:v?"0 2px 6px rgba(37,99,235,0.25)":"none"},title:v?n.unselectAll:n.batchSelectTitle,children:v&&e.jsx(fe,{size:12,color:"#fff",strokeWidth:4})}),e.jsx("div",{style:{flex:1}}),e.jsxs("div",{style:{display:"flex",gap:4,flexShrink:0},children:[e.jsx(G,{title:"상세 보기",color:"#2563eb",bg:"#eff6ff",onClick:()=>j(t),children:e.jsx(Ee,{size:13})}),o&&e.jsxs(e.Fragment,{children:[e.jsx(G,{title:n.edit,color:"#0369a1",bg:"#f0f9ff",onClick:()=>{u(t),S(!0)},children:e.jsx(De,{size:13})}),w?e.jsx(G,{title:n.reopen,color:"#059669",bg:"#ecfdf5",onClick:()=>p(t),children:e.jsx(pe,{size:13})}):e.jsx(G,{title:n.close,color:"#b45309",bg:"#fffbeb",onClick:()=>O(t),children:e.jsx(ue,{size:13})}),e.jsx(G,{title:n.delete,color:"#dc2626",bg:"#fef2f2",onClick:()=>$(t),children:e.jsx(le,{size:13})})]})]})]})]})}function G({children:t,title:a,color:o,bg:j,onClick:u}){const[S,O]=f.useState(!1);return e.jsx("button",{className:"vi-icon-btn",title:a,onClick:u,onMouseEnter:()=>O(!0),onMouseLeave:()=>O(!1),style:{width:30,height:30,display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${S?o:"#e2e8f0"}`,borderRadius:8,background:S?j:"#fff",color:S?o:"#64748b",cursor:"pointer",transition:"all 0.15s"},children:t})}function wt({versions:t,version:a,setVersion:o,setViewMode:j,canManage:u,statusById:S,setStatusById:O,saveVersionStatus:p,handleGoDetail:$,setIsEditModalOpen:P,handleCloseVersion:v,handleReopenVersion:i,handleDeleteVersion:y,setIsCreateModalOpen:w,progressMap:E,handleBatchDelete:W,handleBatchUpdateStatus:D}){const[m,N]=f.useState([]),F=s=>{N(g=>g.includes(s)?g.filter(b=>b!==s):[...g,s])},X=()=>{m.length===t.length&&t.length>0?N([]):N(t.map(s=>s.id))},c=f.useMemo(()=>t.find(s=>s.status==="PENDING")||t.find(s=>s.status==="DRAFT")||null,[t]);c&&ge(c.end_date),f.useMemo(()=>{if(!c||!E?.[c.id]?.length)return{completed:0,inProgress:0,notStarted:0,total:0};const s=E[c.id],g=s.filter(B=>B.dept_status==="COMPLETED").length,b=s.filter(B=>["WRITING","SUBMITTED"].includes(B.dept_status)).length,h=s.filter(B=>["NOT_STARTED","EMPTY"].includes(B.dept_status)).length;return{completed:g,inProgress:b,notStarted:h,total:s.length}},[E,c]),f.useMemo(()=>{const s={DRAFT:0,PENDING:0,CONFIRMED:0,CLOSED:0};return t.forEach(g=>{const b=String(S[g.id]||g.status||"").toUpperCase();s[b]!==void 0&&s[b]++}),{total:t.length,...s}},[t,S]),f.useMemo(()=>c&&E?.[c.id]?.reduce((s,g)=>s+Number(g.total_entries||0),0)||0,[E,c]),f.useMemo(()=>c&&E?.[c.id]?.reduce((s,g)=>s+Number(g.total_amount||0),0)||0,[E,c]);const[l,k]=f.useState("card"),[x,T]=f.useState("active_year"),[I,z]=f.useState("desc"),R=[{value:"active_year",label:n.defaultSort},{value:"year",label:n.year},{value:"round",label:n.round},{value:"name",label:n.name},{value:"status",label:n.status},{value:"start_date",label:n.startDate},{value:"end_date",label:n.endDate},{value:"created_at",label:n.createdAt}],A=()=>z(s=>s==="asc"?"desc":"asc"),C=s=>{if(x===s){A();return}T(s),z("desc")},U=s=>x===s?I==="asc"?" ^":" v":" -",L=f.useMemo(()=>{const s=[...t];return s.sort((g,b)=>{let h=0;if(x==="active_year")return h=ce(g,b),I==="asc"?-h:h;switch(x){case"year":h=Number(g.year||0)-Number(b.year||0);break;case"round":h=Number(g.round||0)-Number(b.round||0);break;case"name":h=String(g.name||"").localeCompare(String(b.name||""),"ko");break;case"status":h=Number(Se[g.status]||99)-Number(Se[b.status]||99);break;case"start_date":h=te(g.start_date)-te(b.start_date);break;case"end_date":h=te(g.end_date)-te(b.end_date);break;case"created_at":h=te(g.created_at)-te(b.created_at);break;default:return h=ce(g,b),I==="asc"?-h:h}return h===0&&(h=ce(g,b)),I==="asc"?h:-h}),s},[t,I,x]),se=f.useMemo(()=>{const s={},g={};return t.forEach(b=>{g[b.year]||(g[b.year]=[]),g[b.year].push(b)}),Object.keys(g).forEach(b=>{g[b].sort((h,B)=>(h.round||0)-(B.round||0)||String(h.id).localeCompare(String(B.id))),g[b].forEach((h,B)=>s[h.id]=B+1)}),s},[t]),K={textAlign:"left",borderBottom:"1px solid #e2e8f0",color:"#64748b",fontWeight:700,padding:"10px 12px",fontSize:12,background:"#f8fafc",whiteSpace:"nowrap"},H={...K,cursor:"pointer",userSelect:"none"},M={borderBottom:"1px solid #f1f5f9",padding:"10px 12px",color:"#334155",fontSize:13,verticalAlign:"middle"};return e.jsxs("div",{className:"version-intake-list",style:{display:"flex",flexDirection:"column",gap:24},children:[e.jsx("style",{children:Ct}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:14,gap:12,flexWrap:"wrap"},children:[e.jsxs("h3",{className:"vi-title",style:{margin:0,fontSize:15,fontWeight:800,color:"#0f172a"},children:[n.listMainTitle,e.jsxs("span",{className:"vi-title-count",style:{marginLeft:8,fontSize:12,fontWeight:600,color:"#94a3b8"},children:["(",t.length,")"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"inline-flex",border:"1px solid #cbd5e1",borderRadius:10,overflow:"hidden",background:"#fff"},children:[e.jsxs("button",{className:"vi-mode-btn",type:"button",onClick:()=>k("card"),style:{border:"none",padding:"8px 10px",background:l==="card"?"#eff6ff":"#fff",color:l==="card"?"#1d4ed8":"#64748b",fontWeight:700,fontSize:12,cursor:"pointer",display:"inline-flex",alignItems:"center",gap:5},title:n.layoutCardTitle,children:[e.jsx(yt,{size:14})," ",n.layoutCard]}),e.jsxs("button",{className:"vi-mode-btn",type:"button",onClick:()=>k("list"),style:{border:"none",borderLeft:"1px solid #e2e8f0",padding:"8px 10px",background:l==="list"?"#eff6ff":"#fff",color:l==="list"?"#1d4ed8":"#64748b",fontWeight:700,fontSize:12,cursor:"pointer",display:"inline-flex",alignItems:"center",gap:5},title:n.layoutListTitle,children:[e.jsx(jt,{size:14})," ",n.layoutList]})]}),e.jsx("select",{className:"vi-sort-select",value:x,onChange:s=>T(s.target.value),style:{...vt,minWidth:190,fontSize:12,padding:"8px 10px"},title:n.sortTitle,children:R.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsxs("button",{className:"vi-sort-btn",type:"button",onClick:A,style:{border:"1px solid #cbd5e1",borderRadius:8,background:"#fff",padding:"8px 10px",fontSize:12,fontWeight:700,color:"#334155",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:6},title:n.sortDirTitle,children:[e.jsx(dt,{size:13}),I==="asc"?n.sortDirAsc:n.sortDirDesc]}),u&&e.jsxs("button",{className:"vi-create-btn",onClick:()=>w(!0),style:{display:"inline-flex",alignItems:"center",gap:6,padding:"8px 16px",borderRadius:10,background:"linear-gradient(135deg,#2563eb,#3b82f6)",color:"#fff",border:"none",cursor:"pointer",fontSize:13,fontWeight:700,boxShadow:"0 2px 8px rgba(37,99,235,0.25)"},children:[e.jsx(Ke,{size:14})," ",n.newRoundBtn]})]})]}),t.length===0?e.jsx("div",{style:{textAlign:"center",padding:"48px 24px",background:"#fff",borderRadius:16,border:"1px dashed #e2e8f0",color:"#94a3b8",fontSize:13},children:"S.noData"}):l==="card"?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",maxWidth:1200,gap:16},children:L.map(s=>e.jsx(_t,{item:s,rank:se[s.id],canManage:u,handleGoDetail:$,setVersion:o,setIsEditModalOpen:P,handleDeleteVersion:y,handleCloseVersion:v,handleReopenVersion:i,progressMap:E,isSelected:m.includes(s.id),onToggleSelect:()=>F(s.id)},s.id))}):e.jsx("div",{style:{background:"#fff",borderRadius:14,border:"1px solid #e2e8f0",overflowX:"auto"},children:e.jsxs("table",{className:"vi-table",style:{width:"100%",borderCollapse:"collapse",minWidth:920},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[u&&e.jsx("th",{style:{...K,width:40,textAlign:"center"},children:e.jsx("div",{onClick:X,style:{width:18,height:18,borderRadius:4,background:m.length===t.length&&t.length>0?"#2563eb":"#fff",border:`2px solid ${m.length===t.length&&t.length>0?"#2563eb":"#cbd5e1"}`,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",margin:"0 auto"},children:m.length===t.length&&t.length>0&&e.jsx(fe,{size:12,color:"#fff",strokeWidth:4})})}),e.jsxs("th",{className:"vi-th",style:H,onClick:()=>C("name"),children:[n.name,U("name")]}),e.jsxs("th",{className:"vi-th",style:H,onClick:()=>C("year"),children:[n.year,U("year")]}),e.jsxs("th",{className:"vi-th",style:H,onClick:()=>C("round"),children:[n.round,U("round")]}),e.jsxs("th",{className:"vi-th",style:H,onClick:()=>C("status"),children:[n.status,U("status")]}),e.jsxs("th",{className:"vi-th",style:H,onClick:()=>C("start_date"),children:[n.start_date||"시작일",U("start_date")]}),e.jsxs("th",{className:"vi-th",style:H,onClick:()=>C("end_date"),children:[n.endDate,U("end_date")]}),e.jsx("th",{className:"vi-th",style:{...K,width:110},children:n.dday}),e.jsx("th",{className:"vi-th",style:{...K,width:110},children:n.guidelinesLabel}),e.jsx("th",{className:"vi-th",style:{...K,width:150,textAlign:"center"},children:n.management})]})}),e.jsx("tbody",{children:L.map(s=>{const g=de[s.status]||de.DRAFT,b=ge(s.end_date),h=s.status==="CLOSED";return e.jsxs("tr",{style:{opacity:h?.72:1,background:m.includes(s.id)?"#eff6ff":"transparent"},children:[u&&e.jsx("td",{style:{...M,textAlign:"center"},children:e.jsx("div",{onClick:()=>F(s.id),style:{width:18,height:18,borderRadius:4,background:m.includes(s.id)?"#2563eb":"#fff",border:`2px solid ${m.includes(s.id)?"#2563eb":"#cbd5e1"}`,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",margin:"0 auto"},children:m.includes(s.id)&&e.jsx(fe,{size:12,color:"#fff",strokeWidth:4})})}),e.jsx("td",{className:"vi-td",style:M,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx("button",{type:"button",className:"vi-list-name",title:"상세 보기",onClick:()=>$(s),style:{color:"#0f172a",fontWeight:700,background:"none",border:"none",padding:0,margin:0,textAlign:"left",cursor:"pointer"},children:s.name}),e.jsxs("span",{className:"vi-list-id",style:{fontSize:11,color:"#94a3b8"},children:["ID ",s.id]})]})}),e.jsx("td",{className:"vi-td",style:M,children:s.year}),e.jsx("td",{className:"vi-td",style:M,children:s.round??0}),e.jsx("td",{className:"vi-td",style:M,children:e.jsxs("span",{className:"vi-status-badge",style:{display:"inline-flex",alignItems:"center",gap:4,padding:"3px 8px",borderRadius:999,background:g.bg,color:g.color,border:"1px solid "+g.border,fontSize:11,fontWeight:700},children:[e.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:g.dot,display:"inline-block"}}),g.label]})}),e.jsx("td",{className:"vi-td",style:M,children:s.start_date||"-"}),e.jsx("td",{className:"vi-td",style:M,children:s.end_date||"-"}),e.jsx("td",{className:"vi-td",style:M,children:b?e.jsx("span",{className:"vi-list-dday-badge",style:{fontSize:11,fontWeight:800,padding:"2px 8px",borderRadius:999,background:b.bg,color:b.color,border:"1px solid "+b.border},children:b.label}):"-"}),e.jsx("td",{className:"vi-td",style:M,children:s.guidelines?e.jsx("span",{style:{color:"#1d4ed8",fontWeight:700,fontSize:12},children:n.guidelinesExist}):e.jsx("span",{style:{color:"#94a3b8",fontSize:12},children:n.guidelinesNone})}),e.jsx("td",{style:{...M,textAlign:"center"},children:e.jsxs("div",{style:{display:"inline-flex",gap:4},children:[e.jsx(G,{title:"상세 보기",color:"#2563eb",bg:"#eff6ff",onClick:()=>$(s),children:e.jsx(Ee,{size:13})}),u&&e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"수정",color:"#0369a1",bg:"#f0f9ff",onClick:()=>{o(s),P(!0)},children:e.jsx(De,{size:13})}),h?e.jsx(G,{title:"재개",color:"#059669",bg:"#ecfdf5",onClick:()=>i(s),children:e.jsx(pe,{size:13})}):e.jsx(G,{title:"마감",color:"#b45309",bg:"#fffbeb",onClick:()=>v(s),children:e.jsx(ue,{size:13})}),e.jsx(G,{title:"삭제",color:"#dc2626",bg:"#fef2f2",onClick:()=>y(s),children:e.jsx(le,{size:13})})]})]})})]},s.id)})})]})})]}),u&&m.length>0&&e.jsxs("div",{style:{position:"fixed",bottom:30,left:"50%",transform:"translateX(-50%)",zIndex:1e3,background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(12px)",padding:"10px 14px 10px 20px",borderRadius:20,border:"1px solid #cbd5e1",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",gap:16,animation:"slideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)"},children:[e.jsx("style",{children:`
                        @keyframes slideUp {
                            from { transform: translate(-50%, 100%) scale(0.9); opacity: 0; }
                            to { transform: translate(-50%, 0) scale(1); opacity: 1; }
                        }
                    `}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:8,background:"#eff6ff",color:"#2563eb",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(St,{size:16})}),e.jsx("span",{style:{fontSize:14,fontWeight:800,color:"#334155"},children:e.jsx("span",{style:{color:"#2563eb"},children:n.batchSelected(m.length)})})]}),e.jsx("div",{style:{width:1,height:24,background:"#e2e8f0"}}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsxs("button",{onClick:async()=>{D(m,"PENDING"),N([])},style:{background:"#fff",border:"1px solid #e2e8f0",color:"#334155",padding:"8px 16px",borderRadius:10,fontSize:13,fontWeight:700,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:6,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},onMouseEnter:s=>{s.currentTarget.style.background="#f8fafc",s.currentTarget.style.borderColor="#cbd5e1"},onMouseLeave:s=>{s.currentTarget.style.background="#fff",s.currentTarget.style.borderColor="#e2e8f0"},children:[e.jsx(pe,{size:15,style:{color:"#2563eb"}})," ",n.batchStart]}),e.jsxs("button",{onClick:async()=>{D(m,"CLOSED"),N([])},style:{background:"#fff",border:"1px solid #e2e8f0",color:"#334155",padding:"8px 16px",borderRadius:10,fontSize:13,fontWeight:700,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:6,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},onMouseEnter:s=>{s.currentTarget.style.background="#f8fafc",s.currentTarget.style.borderColor="#cbd5e1"},onMouseLeave:s=>{s.currentTarget.style.background="#fff",s.currentTarget.style.borderColor="#e2e8f0"},children:[e.jsx(ue,{size:15,style:{color:"#f59e0b"}})," ",n.batchClose]}),e.jsxs("button",{onClick:async()=>{await W(m),N([])},style:{background:"#ef4444",border:"none",color:"#fff",padding:"8px 16px",borderRadius:10,fontSize:13,fontWeight:800,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:6,boxShadow:"0 4px 6px -1px rgba(239,68,68,0.2)"},onMouseEnter:s=>{s.currentTarget.style.background="#dc2626"},onMouseLeave:s=>{s.currentTarget.style.background="#ef4444"},children:[e.jsx(le,{size:15})," ",n.batchDelete]})]}),e.jsx("div",{style:{width:1,height:24,background:"#e2e8f0",marginLeft:4}}),e.jsx("button",{onClick:()=>N([]),style:{background:"transparent",border:"none",color:"#94a3b8",padding:"8px",cursor:"pointer",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:s=>{s.currentTarget.style.background="#f1f5f9",s.currentTarget.style.color="#64748b"},onMouseLeave:s=>{s.currentTarget.style.background="transparent",s.currentTarget.style.color="#94a3b8"},title:n.unselectAll,children:e.jsx(Je,{size:18})})]})]})}const{menuGhostBtn:Tt}=xe,ne={...Tt,padding:"8px 14px",borderRadius:10,fontSize:13,fontWeight:700,display:"inline-flex",alignItems:"center",gap:6},Ce=t=>{if(!t)return"-";const a=new Date(t);return Number.isNaN(a.getTime())?String(t):a.toLocaleDateString("ko-KR")},ae={COMPLETED:{bg:"#f0fdf4",border:"#bbf7d0",color:"#166534",barColor:"#10b981",label:"완료"},SUBMITTED:{bg:"#eff6ff",border:"#bfdbfe",color:"#1d4ed8",barColor:"#3b82f6",label:"제출됨"},WRITING:{bg:"#fffbeb",border:"#fde68a",color:"#b45309",barColor:"#f59e0b",label:"작성중"},NOT_STARTED:{bg:"#f8fafc",border:"#e2e8f0",color:"#94a3b8",barColor:"#cbd5e1",label:"미시작"},EMPTY:{bg:"#f8fafc",border:"#e2e8f0",color:"#cbd5e1",barColor:"#e2e8f0",label:"항목없음"}};function Rt(t){if(!t.length)return 0;const a=t.filter(o=>o.dept_status==="COMPLETED").length;return Math.round(a/t.length*100)}function re({icon:t,iconColor:a,iconBg:o,label:j,value:u,sub:S}){return e.jsxs("div",{style:{background:"#fff",border:"1px solid #e8edf5",borderRadius:14,padding:"14px 18px",display:"flex",alignItems:"flex-start",gap:14,boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[e.jsx("div",{style:{width:36,height:36,borderRadius:10,background:o,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:Te.cloneElement(t,{size:17,style:{color:a}})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#94a3b8",letterSpacing:"0.04em",marginBottom:3},children:j}),e.jsx("div",{style:{fontSize:15,fontWeight:800,color:"#0f172a",lineHeight:1.3},children:u}),S&&e.jsx("div",{style:{marginTop:4},children:S})]})]})}function Et({rate:t}){const a=t===100?"#059669":t>=60?"#2563eb":"#f59e0b",o=t===100?"#ecfdf5":t>=60?"#eff6ff":"#fffbeb";return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,background:o,border:`1px solid ${a}22`,borderRadius:12,padding:"10px 16px"},children:[e.jsx("div",{style:{flex:1},children:e.jsx("div",{style:{height:8,borderRadius:99,background:"#e2e8f0",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",borderRadius:99,background:t===100?"linear-gradient(90deg,#10b981,#059669)":"linear-gradient(90deg,#60a5fa,#2563eb)",width:`${t}%`,transition:"width 0.5s ease"}})})}),e.jsxs("span",{style:{fontSize:15,fontWeight:900,color:a,minWidth:44,textAlign:"right"},children:[t,"%"]})]})}function Dt({version:t,canManage:a,setViewMode:o,fetchProgress:j,progressData:u=[],loadingProgress:S,setIsEditModalOpen:O,onExportBudgetBook:p,onClose:$,onReopen:P}){const v=u.reduce((c,l)=>c+Number(l.total_entries||0),0),i=u.reduce((c,l)=>c+Number(l.total_amount||0),0),y=Rt(u),w=t?.status==="CLOSED",[E,W]=f.useState({}),D=c=>W(l=>({...l,[c]:!l[c]})),m=u.filter(c=>c.dept_status==="COMPLETED").length,N=u.filter(c=>["WRITING","SUBMITTED"].includes(c.dept_status)).length,F=f.useMemo(()=>{const c={};return u.forEach(l=>{const k=l.org_id,x=l.parent_id,T=x||k;c[T]||(c[T]={dept:null,teams:[]}),x?c[T].teams.push({...l}):c[T].dept={...l}}),Object.values(c).map(l=>{if(!l.dept){if(!l.teams.length)return null;l.dept={...l.teams[0],org_name:`${l.teams[0].org_name} (그룹)`,isPlaceholder:!0}}if(l.teams.length>0){const k=l.teams.reduce((T,I)=>(T.total_entries+=Number(I.total_entries||0),T.total_amount+=Number(I.total_amount||0),T.finalized+=Number(I.status_counts?.FINALIZED||0),T),{total_entries:Number(l.dept.total_entries||0),total_amount:Number(l.dept.total_amount||0),finalized:Number(l.dept.status_counts?.FINALIZED||0)});l.dept.total_entries=k.total_entries,l.dept.total_amount=k.total_amount;const x=k.total_entries>0?Math.round(k.finalized/k.total_entries*100):0;l.dept.aggregatedBarPct=x,k.total_entries>0&&(x===100?l.dept.dept_status="COMPLETED":x>0?l.dept.dept_status="SUBMITTED":l.dept.dept_status="WRITING")}else{const k=Number(l.dept.total_entries||0),x=Number(l.dept.status_counts?.FINALIZED||0);l.dept.aggregatedBarPct=k>0?Math.round(x/k*100):0}return l}).filter(Boolean).sort((l,k)=>(l.dept.org_name||"").localeCompare(k.dept.org_name||""))},[u]),X=c=>{window.location.assign(`/api/versions/${t.id}/export-department-budget/?org_id=${c}`)};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:10,background:"#fff",border:"1px solid #e2e8f0",borderRadius:14,padding:"14px 20px",boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsxs("button",{type:"button",style:ne,onClick:()=>o("list"),children:[e.jsx(it,{size:14})," ",n.goToList]}),e.jsx("div",{style:{width:1,height:20,background:"#e2e8f0"}}),e.jsxs("span",{style:{fontSize:15,fontWeight:800,color:"#0f172a"},children:[t?.year,"년 ",t?.name]}),e.jsx(nt,{status:t?.status,type:"version"})]}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsxs("button",{type:"button",style:ne,onClick:()=>j(),children:[e.jsx(me,{size:14})," ",n.refreshStatus]}),e.jsxs("button",{type:"button",style:ne,onClick:p,children:[e.jsx(je,{size:14})," ",n.exportOfficialBook]}),a&&e.jsxs("button",{type:"button",style:ne,onClick:()=>O(!0),children:[e.jsx(Ge,{size:14})," ",n.editRoundBtn]}),a&&t&&(w?e.jsxs("button",{type:"button",onClick:()=>P?.(t),style:{...ne,border:"1px solid #86efac",background:"#f0fdf4",color:"#166534"},children:[e.jsx(Qe,{size:14})," 마감 해제"]}):e.jsxs("button",{type:"button",onClick:()=>$?.(t),style:{...ne,border:"1px solid #fca5a5",background:"#fff1f2",color:"#b91c1c"},children:[e.jsx(qe,{size:14})," 회차 마감"]}))]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:12},children:[e.jsx(re,{icon:e.jsx(bt,{}),iconColor:"#6366f1",iconBg:"#eef2ff",label:"예산 회차",value:`${t?.year}년 / ${t?.name||`${t?.round??0}차`}`}),e.jsx(re,{icon:e.jsx(Ne,{}),iconColor:"#0ea5e9",iconBg:"#f0f9ff",label:"입력 기간",value:`${Ce(t?.start_date)} ~ ${Ce(t?.end_date)}`}),e.jsx(re,{icon:e.jsx(Re,{}),iconColor:"#f59e0b",iconBg:"#fffbeb",label:"총 예산 항목",value:`${v.toLocaleString()}건`}),e.jsx(re,{icon:e.jsx(rt,{}),iconColor:"#10b981",iconBg:"#ecfdf5",label:"총 예산 금액",value:i>0?`${i.toLocaleString()}원`:"집계 전"}),e.jsx(re,{icon:e.jsx(et,{}),iconColor:"#059669",iconBg:"#ecfdf5",label:"부서 완료 현황",value:u.length>0?`${m} / ${u.length}`:"—",sub:u.length>0&&e.jsxs("div",{style:{display:"flex",gap:8,fontSize:11},children:[e.jsxs("span",{style:{color:"#059669",fontWeight:700},children:["✅ 완료 ",m]}),e.jsxs("span",{style:{color:"#d97706",fontWeight:700},children:["⏳ 진행 ",N]}),e.jsxs("span",{style:{color:"#94a3b8"},children:["⚪ 미시작 ",u.length-m-N]})]})}),e.jsx(re,{icon:e.jsx(st,{}),iconColor:"#2563eb",iconBg:"#eff6ff",label:"전체 완료율",value:u.length>0?`${y}%`:"—",sub:u.length>0&&e.jsx("div",{style:{height:5,borderRadius:99,background:"#e2e8f0",overflow:"hidden",marginTop:6},children:e.jsx("div",{style:{height:"100%",borderRadius:99,background:y===100?"linear-gradient(90deg,#10b981,#059669)":"linear-gradient(90deg,#60a5fa,#2563eb)",width:`${y}%`,transition:"width 0.5s"}})})})]}),e.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:16,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.05)"},children:[e.jsxs("div",{style:{padding:"16px 22px",borderBottom:"1px solid #f1f5f9",display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f8fafc"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:14,fontWeight:800,color:"#0f172a"},children:[e.jsx(me,{size:16,style:{color:"#3b82f6"}}),n.progressByDept]}),u.length>0&&e.jsx("div",{style:{minWidth:220},children:e.jsx(Et,{rate:y})})]}),S?e.jsx("div",{style:{padding:60},children:e.jsx(He,{message:n.loadingProgress})}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f8fafc",borderBottom:"2px solid #e2e8f0"},children:[{label:n.dept,align:"left",pl:22},{label:n.status,align:"center",w:100},{label:"진행률",align:"left",w:180},{label:n.entryCount,align:"right"},{label:n.totalAmount,align:"right"},{label:"출력",align:"right",pr:22}].map(({label:c,align:l,w:k,pl:x,pr:T})=>e.jsx("th",{style:{padding:"10px 14px",...x?{paddingLeft:x}:{},...T?{paddingRight:T}:{},...k?{width:k}:{},textAlign:l,fontSize:11,fontWeight:700,color:"#64748b",letterSpacing:"0.04em",whiteSpace:"nowrap"},children:c},c))})}),e.jsx("tbody",{children:F.length?F.map((c,l)=>{const k=c.dept,x=ae[k.dept_status]||ae.NOT_STARTED,T=k.aggregatedBarPct??0,I=E[k.org_id],z=c.teams.length>0;return e.jsxs(Te.Fragment,{children:[e.jsxs("tr",{style:{background:l%2===0?"#fff":"#fafbfc",borderBottom:"1px solid #f1f5f9",cursor:z?"pointer":"default",transition:"background 0.12s"},onMouseEnter:R=>{R.currentTarget.style.background="#f0f4ff"},onMouseLeave:R=>{R.currentTarget.style.background=l%2===0?"#fff":"#fafbfc"},onClick:()=>z&&D(k.org_id),children:[e.jsx("td",{style:{padding:"11px 14px",paddingLeft:22,fontWeight:700,color:"#0f172a",fontSize:13},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:7},children:[z?I?e.jsx(ut,{size:13,style:{color:"#64748b",flexShrink:0}}):e.jsx(ot,{size:13,style:{color:"#64748b",flexShrink:0}}):e.jsx("div",{style:{width:13}}),k.org_name||"-",z&&e.jsxs("span",{style:{fontSize:10,fontWeight:700,color:"#94a3b8",background:"#f1f5f9",borderRadius:4,padding:"1px 5px"},children:[c.teams.length,"팀"]})]})}),e.jsx("td",{style:{padding:"11px 14px",textAlign:"center"},children:e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,fontSize:11,fontWeight:700,padding:"3px 9px",borderRadius:999,background:x.bg,color:x.color,border:`1px solid ${x.border}`},children:[e.jsx("span",{style:{width:5,height:5,borderRadius:"50%",background:x.barColor,display:"inline-block"}}),x.label]})}),e.jsx("td",{style:{padding:"11px 14px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{flex:1,height:7,borderRadius:99,background:"#f1f5f9",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",borderRadius:99,background:k.dept_status==="COMPLETED"?"linear-gradient(90deg,#10b981,#059669)":`linear-gradient(90deg,${x.barColor}99,${x.barColor})`,width:`${T}%`,transition:"width 0.4s"}})}),e.jsxs("span",{style:{fontSize:11,fontWeight:800,color:x.color,minWidth:34,textAlign:"right"},children:[T,"%"]})]})}),e.jsx("td",{style:{padding:"11px 14px",textAlign:"right",fontSize:13,color:"#334155",fontVariantNumeric:"tabular-nums"},children:Number(k.total_entries||0).toLocaleString()}),e.jsx("td",{style:{padding:"11px 14px",textAlign:"right",fontSize:13,fontWeight:700,color:"#0f172a",fontVariantNumeric:"tabular-nums"},children:Number(k.total_amount||0).toLocaleString()}),e.jsx("td",{style:{padding:"11px 14px",paddingRight:22,textAlign:"right"},children:e.jsxs("button",{onClick:R=>{R.stopPropagation(),X(k.org_id)},style:{display:"inline-flex",alignItems:"center",gap:5,fontSize:11,fontWeight:700,padding:"5px 12px",borderRadius:7,background:"#fff",border:"1px solid #e2e8f0",color:"#334155",cursor:"pointer",transition:"all 0.15s"},onMouseEnter:R=>{R.currentTarget.style.borderColor="#2563eb",R.currentTarget.style.color="#2563eb"},onMouseLeave:R=>{R.currentTarget.style.borderColor="#e2e8f0",R.currentTarget.style.color="#334155"},children:[e.jsx(je,{size:12})," 예산서"]})})]}),I&&c.teams.map(R=>{const A=ae[R.dept_status]||ae.NOT_STARTED,C=Number(R.total_entries||0),U=Number(R.status_counts?.FINALIZED||0),L=C>0?Math.round(U/C*100):0;return e.jsxs("tr",{style:{background:"#f8fafc",borderBottom:"1px solid #f1f5f9"},children:[e.jsx("td",{style:{padding:"9px 14px 9px 44px",color:"#475569",fontSize:12},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{style:{color:"#cbd5e1"},children:"└"}),R.org_name||"-"]})}),e.jsx("td",{style:{padding:"9px 14px",textAlign:"center"},children:e.jsx("span",{style:{display:"inline-block",fontSize:10,fontWeight:700,padding:"2px 7px",borderRadius:999,background:A.bg,color:A.color,border:`1px solid ${A.border}`},children:A.label})}),e.jsx("td",{style:{padding:"9px 14px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{flex:1,height:5,borderRadius:99,background:"#e2e8f0",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",borderRadius:99,background:A.barColor,width:`${L}%`}})}),e.jsxs("span",{style:{fontSize:11,fontWeight:700,color:A.color,minWidth:34,textAlign:"right"},children:[L,"%"]})]})}),e.jsx("td",{style:{padding:"9px 14px",textAlign:"right",fontSize:12,color:"#475569",fontVariantNumeric:"tabular-nums"},children:C.toLocaleString()}),e.jsx("td",{style:{padding:"9px 14px",textAlign:"right",fontSize:12,fontWeight:600,color:"#334155",fontVariantNumeric:"tabular-nums"},children:Number(R.total_amount||0).toLocaleString()}),e.jsx("td",{})]},R.org_id)})]},l)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{padding:32,textAlign:"center",color:"#94a3b8",fontSize:13},children:n.noProgressData})})})]})]})]})}const{simpleLabel:ee,simpleInput:ie,simpleSelect:_e,simpleTextarea:Nt}=xe;function we({data:t,setData:a,currentFileUrl:o,isCreate:j=!1,fileInputId:u,transferSourceOptions:S}){const[O,p]=f.useState(t.name||""),[$,P]=f.useState(t.guidelines||"");f.useEffect(()=>{queueMicrotask(()=>{p(t.name||"")})},[t.name]),f.useEffect(()=>{queueMicrotask(()=>{P(t.guidelines||"")})},[t.guidelines]);const v=(i,y)=>{a(w=>({...w,[i]:y}))};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:12},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx("label",{style:{...ee,fontSize:13,color:"#64748b"},children:n.applyYear}),e.jsx("input",{type:"number",style:{...ie,borderRadius:10,padding:"10px 14px"},value:t.year,onChange:i=>{const y=parseInt(i.target.value);a(w=>({...w,year:y}))}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx("label",{style:{...ee,fontSize:13,color:"#64748b"},children:n.roundName}),e.jsx("input",{style:{...ie,borderRadius:10,padding:"10px 14px"},placeholder:n.namePlaceholder,value:O,onChange:i=>p(i.target.value),onCompositionEnd:i=>v("name",i.currentTarget.value),onBlur:i=>v("name",i.target.value)})]})]}),j&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:t.creation_mode==="TRANSFER"?"1fr 1fr":"1fr",gap:12,background:"#f8fafc",padding:12,borderRadius:12,border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx("label",{style:{...ee,fontSize:12,color:"#475569",fontWeight:750},children:n.createMode}),e.jsxs("select",{style:{..._e,borderRadius:8,padding:"8px 12px",background:"#fff"},value:t.creation_mode||"NEW",onChange:i=>{const y=i.target.value;a(w=>({...w,creation_mode:y,source_version_id:y==="TRANSFER"?w.source_version_id:""}))},children:[e.jsx("option",{value:"NEW",children:n.newCreate}),e.jsx("option",{value:"TRANSFER",children:n.copyRound})]})]}),t.creation_mode==="TRANSFER"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx("label",{style:{...ee,fontSize:12,color:"#475569",fontWeight:750},children:n.originalRound}),e.jsxs("select",{style:{..._e,borderRadius:8,padding:"8px 12px",background:"#fff"},value:t.source_version_id||"",onChange:i=>{const y=i.target.value;a(w=>({...w,source_version_id:y}))},children:[e.jsx("option",{value:"",children:n.selectOriginal}),S.map(i=>e.jsxs("option",{value:i.id,children:[i.year," ",i.name," (",i.round??0,"차)"]},i.id))]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx("label",{style:{...ee,fontSize:13,color:"#64748b"},children:n.periodSetting}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto 1fr",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"date",style:{...ie,borderRadius:10,padding:"10px 14px"},value:t.start_date,onChange:i=>{const y=i.target.value;a(w=>({...w,start_date:y}))}}),e.jsx("span",{style:{color:"#94a3b8",fontSize:18},children:"~"}),e.jsx("input",{type:"date",style:{...ie,borderRadius:10,padding:"10px 14px"},value:t.end_date,onChange:i=>{const y=i.target.value;a(w=>({...w,end_date:y}))}})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx("label",{style:{...ee,fontSize:13,color:"#64748b"},children:n.guidelinesLabel}),e.jsx("textarea",{style:{...Nt,height:74,borderRadius:10,padding:"12px 14px"},value:$,onChange:i=>P(i.target.value),onCompositionEnd:i=>v("guidelines",i.currentTarget.value),onBlur:i=>v("guidelines",i.target.value),placeholder:n.guidelinesPlaceholder})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx("label",{style:{...ee,fontSize:13,color:"#64748b"},children:n.fileUploadLabel}),e.jsxs("div",{style:{border:"1.5px dashed #cbd5e1",borderRadius:10,padding:"12px",textAlign:"center",cursor:"pointer",transition:"all 0.2s",position:"relative",background:"#fcfdfe"},onClick:()=>document.getElementById(u).click(),onMouseEnter:i=>{i.currentTarget.style.borderColor="#2563eb",i.currentTarget.style.background="#f1f6ff"},onMouseLeave:i=>{i.currentTarget.style.borderColor="#cbd5e1",i.currentTarget.style.background="#fcfdfe"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[e.jsx(tt,{size:18,color:"#64748b"}),e.jsx("div",{style:{fontSize:13,color:"#475569",fontWeight:600},children:t.file?t.file.name:o?`${n.currentFile}${o.split("/").pop()}`:n.uploadPlaceholder})]}),e.jsx("input",{id:u,type:"file",style:{display:"none"},onChange:i=>{const y=i.target.files[0];a(w=>({...w,file:y}))}}),(t.file||o)&&e.jsx("button",{type:"button",style:{position:"absolute",top:"50%",right:12,transform:"translateY(-50%)",background:"#fee2e2",border:"none",cursor:"pointer",color:"#ef4444",borderRadius:"50%",width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center"},onClick:i=>{i.stopPropagation(),a(y=>({...y,file:null}))},title:n.removeFile,children:e.jsx(le,{size:13})})]})]})]})}function Bt({menuId:t,authAxios:a,version:o,versions:j,setVersion:u,onBootstrap:S,user:O,modalApi:p,initialUrlParams:$={}}){const P=()=>({year:new Date().getFullYear(),name:"",start_date:"",end_date:"",guidelines:"",file:null,creation_mode:"NEW",source_version_id:""}),[v,i]=f.useState(()=>$.versionId?"detail":"list"),[y,w]=f.useState({}),[,E]=f.useState(null),[W,D]=f.useState({}),[m,N]=f.useState(!1),[F,X]=f.useState(new Date().getFullYear().toString()),[c,l]=f.useState(!1),[k,x]=f.useState(!1),[T,I]=f.useState(null),[z,R]=f.useState(""),A=f.useRef(null),[C,U]=f.useState(P()),[L,se]=f.useState({year:"",name:"",start_date:"",end_date:"",guidelines:""}),[K,H]=f.useState(!1),[M,s]=f.useState(""),[,g]=f.useState(null),b=O?.role==="ADMIN",h=f.useCallback(async r=>{const d=r||o?.id;if(d){N(!0);try{const _=await a.get(`/api/versions/${d}/progress/`);D(V=>({...V,[d]:_.data}))}catch(_){console.error(_)}finally{N(!1)}}},[a,o?.id]);f.useEffect(()=>{const r={};j.forEach(d=>{r[d.id]=d.status}),w(r)},[j]),f.useEffect(()=>{v==="list"&&j.filter(d=>["PENDING","DRAFT","EXPIRED"].includes(d.status)).forEach(d=>{W[d.id]||h(d.id)})},[v,j,W,h]),f.useEffect(()=>{o&&o.id&&(v==="detail"&&h(o.id),se({year:o.year,name:o.name,start_date:o.start_date||"",end_date:o.end_date||"",guidelines:o.guidelines||""}))},[o,v,h]);const B=f.useRef(!1);f.useEffect(()=>{if(B.current||!j.length)return;const r=$.versionId;if(!r)return;const d=j.find(_=>_.id===r);d&&(u(d),i("detail")),B.current=!0},[j,$.versionId,u]),f.useEffect(()=>{if(v==="detail"&&o?.id){const r=`/intake/versions/${o.id}`;window.location.pathname!==r&&window.history.pushState({},"",r)}else v==="list"&&window.location.pathname!=="/intake"&&window.history.pushState({},"","/intake")},[v,o?.id]);const Ie=f.useMemo(()=>[...j].sort((r,d)=>d.year-r.year||d.round-r.round),[j]),ze=f.useMemo(()=>{const r=new Set(j.map(d=>d.year.toString()));return Array.from(r).sort((d,_)=>_-d)},[j]),Le=f.useMemo(()=>F==="ALL"?j:j.filter(r=>r.year.toString()===F),[j,F]),We=async r=>{if(await p.confirm(n.confirmDelete(r.name)))try{await a.delete(`/api/versions/${r.id}/`),await S(),await p.alert(n.deleteSuccess)}catch(d){if(d.response?.status===409&&d.response?.data?.can_force){const _=d.response.data.entry_count;R(""),I({version:r,entryCount:_}),setTimeout(()=>A.current?.focus(),80)}else await p.alert(Y(d,n.deleteFail))}},be=async()=>{if(T)try{await a.delete(`/api/versions/${T.version.id}/force-delete/`),I(null),await S(),await p.alert(n.deleteSuccess)}catch(r){await p.alert(Y(r,n.deleteFail))}},he=async r=>{if(await p.confirm(n.confirmClose(r.name)))try{await a.post(`/api/versions/${r.id}/close/`),await S(),await p.alert(n.closeSuccess)}catch(d){await p.alert(Y(d,n.closeFail))}},ye=async r=>{if(await p.confirm(n.confirmReopen(r.name)))try{await a.post(`/api/versions/${r.id}/reopen/`),await S(),await p.alert(n.reopenSuccess)}catch(d){await p.alert(Y(d,n.reopenFail))}},Me=async()=>{try{if(C.creation_mode==="TRANSFER"&&!C.source_version_id){await p.alert(n.transferRequired);return}const r=new FormData;r.append("year",C.year),r.append("name",C.name||n.newRoundName(C.year)),r.append("start_date",C.start_date),r.append("end_date",C.end_date),r.append("guidelines",C.guidelines),r.append("creation_mode",C.creation_mode||"NEW"),r.append("base_data_mode",(C.creation_mode||"NEW")==="TRANSFER"?"IMPORT_PREVIOUS":"NEW"),C.source_version_id&&(r.append("source_version_id",C.source_version_id),r.append("base_version_id",C.source_version_id)),C.file&&r.append("guidelines_file",C.file);const d=await a.post("/api/versions/create_next_round/",r,{headers:{"Content-Type":"multipart/form-data"}});await S(),l(!1),U(P());const _=Number(d?.data?.cloned_count||0);await p.alert(n.createSuccess(_))}catch(r){const _=r?.response?.data?.error==="source version has no entries"?n.sourceVersionEmpty:Y(r,n.createFail);await p.alert(_)}},$e=async r=>{const d=y[r.id];if(!(!d||d===r.status)){E(r.id);try{await a.patch(`/api/versions/${r.id}/`,{status:d,confirmed_at:d==="CONFIRMED"?new Date().toISOString():null}),await S(),await p.alert(n.updateSuccess)}catch(_){await p.alert(Y(_,n.updateFail))}finally{E(null)}}},Pe=async()=>{if(o)try{const r=new FormData;r.append("year",L.year),r.append("name",L.name),r.append("start_date",L.start_date),r.append("end_date",L.end_date),r.append("guidelines",L.guidelines),L.file?r.append("guidelines_file",L.file):L.file===null&&o.guidelines_file&&r.append("guidelines_file","");const d=await a.patch(`/api/versions/${o.id}/`,r,{headers:{"Content-Type":"multipart/form-data"}});u(d.data),await S(),x(!1),se({year:"",name:"",start_date:"",end_date:"",guidelines:"",file:null}),await p.alert(n.saveSuccess)}catch(r){await p.alert(Y(r,n.saveFail))}},Fe=async()=>{if(!M.trim())return p.alert(n.inputRequired);try{const d=M.trim().split(`
`).map(V=>{const[Z,J,oe,Q,Ve]=V.split(",").map(Ye=>Ye.trim());return{subject_code:Z,org_code:J,details:[{name:oe,price:parseInt(Q)||0,qty:parseFloat(Ve)||0,freq:1,source:"자체"}]}}).filter(V=>V.subject_code&&V.org_code),_=await a.post("/api/entries/bulk-upsert/",{year:o.year,round:o.round||0,entries:d});g(_.data),await S(),s(""),await p.alert(n.uploadSuccess(_.data.created,_.data.updated)),h(o.id)}catch(r){await p.alert(Y(r,n.uploadFail))}},Be=async r=>{if(r?.length&&await p.confirm(`선택한 ${r.length}개의 예산서를 삭제하시겠습니까?`))try{const d=await a.post("/api/versions/bulk-delete/",{ids:r}),_=d.data.deleted_ids?.length||0,V=d.data.errors?.length||0;if(await S(),V>0){const Z=d.data.errors.filter(J=>J.entry_count>0);Z.length>0?await p.confirm(`${Z.length}개의 예산서에 기존 데이터가 존재합니다. 강제로 삭제하시겠습니까?`)&&(await a.post("/api/versions/bulk-delete/",{ids:Z.map(J=>J.id),force:!0}),await S(),await p.alert("강제 삭제가 완료되었습니다.")):await p.alert(`${_}개 삭제 성공, ${V}개 실패.`)}else await p.alert(`${_}개의 예산서가 삭제되었습니다.`)}catch(d){await p.alert(Y(d,"일괄 삭제에 실패했습니다."))}},Oe=async(r,d)=>{if(r?.length)try{await a.post("/api/versions/bulk-update-status/",{ids:r,status:d}),await S(),await p.alert("상태 변경이 완료되었습니다.")}catch(_){await p.alert(Y(_,"상태 변경에 실패했습니다."))}},Ae=r=>{u(r),i("detail")},Ue=async()=>{if(o?.id)try{const r=await a.get(`/api/versions/${o.id}/export-budget-book/`,{responseType:"blob"}),_=(r.headers?.["content-disposition"]||"").match(/filename\*=UTF-8''([^;]+)/i),V=`budget_book_${o.year}_r${o.round}.xlsx`,Z=_?decodeURIComponent(_[1]):V,J=new Blob([r.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),oe=window.URL.createObjectURL(J),Q=document.createElement("a");Q.href=oe,Q.download=Z,document.body.appendChild(Q),Q.click(),Q.remove(),window.URL.revokeObjectURL(oe),await p.alert(n.exportOfficialBookDone)}catch(r){await p.alert(Y(r,n.exportOfficialBookFail))}};return e.jsxs(Xe,{menuId:t,user:O,breadcrumbs:v==="detail"?[{label:n.pageTitle,onClick:()=>i("list")},{label:n.listTitle,onClick:()=>i("list")},`${n.detailTitle} (${o?.name||""})`]:[n.pageTitle,n.listTitle],contextBadge:v==="list"?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("span",{style:{fontSize:12,fontWeight:800,color:"#64748b"},children:"예산연도"}),e.jsxs("select",{value:F,onChange:r=>X(r.target.value),style:{padding:"3px 10px",borderRadius:8,border:"1px solid #cbd5e1",background:"#fff",fontSize:12,fontWeight:700,color:"#0891b2",cursor:"pointer",outline:"none"},children:[e.jsx("option",{value:"ALL",children:"전체보기"}),ze.map(r=>e.jsxs("option",{value:r,children:[r,"년"]},r))]})]}):o?`${o.year}년 ${o.name}`:"",hideHero:!0,children:[e.jsx("div",{style:{padding:"0 20px 40px 20px"},children:v==="list"?e.jsx(wt,{versions:Le,version:o,setVersion:u,setViewMode:i,canManage:b,statusById:y,setStatusById:w,saveVersionStatus:$e,handleGoDetail:Ae,setIsEditModalOpen:x,handleCloseVersion:he,handleReopenVersion:ye,handleDeleteVersion:We,setIsCreateModalOpen:l,progressMap:W,handleBatchDelete:Be,handleBatchUpdateStatus:Oe}):e.jsx(Dt,{version:o,canManage:b,setViewMode:i,fetchProgress:h,progressData:W[o?.id]||[],loadingProgress:m,setIsEditModalOpen:x,handleBulkUpload:Fe,csvContent:M,setCsvContent:s,isBulkExpanded:K,setIsBulkExpanded:H,onExportBudgetBook:Ue,onClose:he,onReopen:ye})}),e.jsx(ke,{isOpen:c,onClose:()=>l(!1),title:n.newRoundBtn,width:560,footer:e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",style:{background:"#fff",color:"#64748b",border:"1px solid #cbd5e1",padding:"10px 20px",borderRadius:10,fontWeight:700,fontSize:14,cursor:"pointer"},onClick:()=>l(!1),children:n.cancel}),e.jsx("button",{type:"button",style:{background:"linear-gradient(135deg, #2563eb 0%, #3b82f6 100%)",color:"#fff",border:"none",padding:"10px 28px",borderRadius:10,fontWeight:800,fontSize:14,cursor:"pointer",boxShadow:"0 4px 12px rgba(37,99,235,0.25)",transition:"all 0.2s"},onClick:Me,onMouseEnter:r=>r.currentTarget.style.transform="translateY(-1px)",onMouseLeave:r=>r.currentTarget.style.transform="none",children:n.newRoundBtn})]}),children:e.jsx(we,{data:C,setData:U,isCreate:!0,fileInputId:"version-file-input-create",transferSourceOptions:Ie})}),e.jsx(ke,{isOpen:k,onClose:()=>x(!1),title:n.editRoundBtn,width:560,footer:e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",style:{background:"#fff",color:"#64748b",border:"1px solid #cbd5e1",padding:"10px 20px",borderRadius:10,fontWeight:700,fontSize:14,cursor:"pointer"},onClick:()=>x(!1),children:n.cancel}),e.jsx("button",{type:"button",style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"#fff",border:"none",padding:"10px 28px",borderRadius:10,fontWeight:800,fontSize:14,cursor:"pointer",boxShadow:"0 4px 12px rgba(16,185,129,0.25)",transition:"all 0.2s"},onClick:Pe,onMouseEnter:r=>r.currentTarget.style.transform="translateY(-1px)",onMouseLeave:r=>r.currentTarget.style.transform="none",children:n.save})]}),children:e.jsx(we,{data:L,setData:se,currentFileUrl:o?.guidelines_file,fileInputId:"version-file-input-edit"})}),T&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:9999,background:"rgba(15,23,42,0.55)",backdropFilter:"blur(3px)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:20,width:480,maxWidth:"90vw",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.35)",overflow:"hidden"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)",padding:"20px 24px",display:"flex",alignItems:"center",gap:12},children:[e.jsx(Ze,{size:22,color:"#fff"}),e.jsx("span",{style:{color:"#fff",fontWeight:800,fontSize:17},children:"예산서 강제 삭제"})]}),e.jsxs("div",{style:{padding:"24px 24px 20px"},children:[e.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #fca5a5",borderRadius:12,padding:"14px 16px",marginBottom:20},children:[e.jsx("p",{style:{margin:0,fontWeight:700,color:"#b91c1c",fontSize:14,marginBottom:6},children:"⚠ 이 작업은 되돌릴 수 없습니다"}),e.jsxs("p",{style:{margin:0,color:"#7f1d1d",fontSize:13,lineHeight:1.6},children:[e.jsxs("strong",{children:['"',T.version.name,'"']})," 예산서와 연결된"," ",e.jsxs("strong",{children:["예산 항목 ",T.entryCount.toLocaleString(),"건"]}),"이 모두 영구 삭제됩니다."]})]}),e.jsxs("p",{style:{margin:"0 0 10px",fontSize:13,color:"#475569",fontWeight:600},children:["계속하려면 아래 입력란에 ",e.jsx("code",{style:{background:"#f1f5f9",padding:"2px 7px",borderRadius:5,fontFamily:"monospace",fontWeight:800,color:"#dc2626",fontSize:13},children:"DELETE"})," 를 입력하세요."]}),e.jsx("input",{ref:A,type:"text",value:z,onChange:r=>R(r.target.value),onKeyDown:r=>{r.key==="Enter"&&z==="DELETE"&&be()},placeholder:"DELETE",style:{width:"100%",boxSizing:"border-box",border:`2px solid ${z==="DELETE"?"#dc2626":"#e2e8f0"}`,borderRadius:10,padding:"10px 14px",fontSize:15,fontWeight:700,fontFamily:"monospace",outline:"none",color:"#0f172a",transition:"border-color 0.2s"}})]}),e.jsxs("div",{style:{padding:"0 24px 24px",display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:()=>{I(null),R("")},style:{padding:"10px 22px",borderRadius:10,border:"1px solid #e2e8f0",background:"#f8fafc",color:"#475569",fontWeight:700,cursor:"pointer",fontSize:14},children:"취소"}),e.jsx("button",{type:"button",disabled:z!=="DELETE",onClick:be,style:{padding:"10px 22px",borderRadius:10,border:"none",background:z==="DELETE"?"#dc2626":"#fca5a5",color:"#fff",fontWeight:800,fontSize:14,cursor:z==="DELETE"?"pointer":"not-allowed",transition:"background 0.2s",boxShadow:z==="DELETE"?"0 4px 6px -1px rgba(220,38,38,0.3)":"none"},children:"강제 삭제"})]})]})})]})}export{Bt as default};
